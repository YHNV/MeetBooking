<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- <mapper namespace="com.example.mapper.UserMapper"> -->

<mapper namespace="com.zb.backend.mapper.TokenMapper">
    <resultMap id="DepartmentResultMap" type="com.zb.backend.entity.Token">
        <result property="id" column="id"/>
        <result property="token" column="token"/>
        <result property="accountId" column="account_id"/>
        <result property="expiryTime" column="expiry_time"/>
    </resultMap>

    <insert id="insertToken">
        insert into TOKENS (TOKEN, ACCOUNT_ID, EXPIRY_TIME)
        values (#{token}, #{accountId}, #{expiryTime});
    </insert>
    <!-- &lt; 是 XML 转义符，代表 <（避免语法冲突）。 -->
    <delete id="deleteExpiredTokens">
        delete from TOKENS where EXPIRY_TIME &lt; #{now};
    </delete>
    <delete id="deleteTokenByAccountId">
        delete from TOKENS where ACCOUNT_ID = #{accountId};
    </delete>
    <select id="selectByToken" resultType="com.zb.backend.entity.Token">
        select id, token, account_id, expiry_time from TOKENS where TOKEN = #{token};
    </select>
    <select id="selectTokenByAccountId" resultType="com.zb.backend.entity.Token">
        select id, token, account_id, expiry_time
        from TOKENS
        where ACCOUNT_ID = #{accountId};
    </select>
</mapper>